(function(t){function e(e){for(var s,o,a=e[0],c=e[1],l=e[2],d=0,h=[];d<a.length;d++)o=a[d],Object.prototype.hasOwnProperty.call(n,o)&&n[o]&&h.push(n[o][0]),n[o]=0;for(s in c)Object.prototype.hasOwnProperty.call(c,s)&&(t[s]=c[s]);u&&u(e);while(h.length)h.shift()();return r.push.apply(r,l||[]),i()}function i(){for(var t,e=0;e<r.length;e++){for(var i=r[e],s=!0,a=1;a<i.length;a++){var c=i[a];0!==n[c]&&(s=!1)}s&&(r.splice(e--,1),t=o(o.s=i[0]))}return t}var s={},n={app:0},r=[];function o(e){if(s[e])return s[e].exports;var i=s[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,o),i.l=!0,i.exports}o.m=t,o.c=s,o.d=function(t,e,i){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(o.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)o.d(i,s,function(e){return t[e]}.bind(null,s));return i},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/vue_chatpm/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],c=a.push.bind(a);a.push=e,a=a.slice();for(var l=0;l<a.length;l++)e(a[l]);var u=c;r.push([0,"chunk-vendors"]),i()})({0:function(t,e,i){t.exports=i("56d7")},"0808":function(t,e,i){"use strict";var s=i("15c0"),n=i.n(s);n.a},"15c0":function(t,e,i){},"3aaf":function(t,e,i){t.exports=i.p+"img/smile_logo.9680df60.png"},"56d7":function(t,e,i){"use strict";i.r(e);var s=i("2b0e"),n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"app"}},[t._m(0),i("section",[i("canvas"),i("ChatFrame",{ref:"chatframe",attrs:{messages:t.messages}}),i("div",{attrs:{id:"inputFrame"}},[i("Input",{on:{send:t.send,write:t.write}})],1)],1),t._m(1)])},r=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("header",[i("h1",[t._v("ЧАТ")])])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"info"}},[i("pre",[t._v("Enter - отправить")])])}],o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"frame"}},[i("section",t._l(t.messages,(function(t,e){return i("Message",{key:e,attrs:{message:t}})})),1),i("div",{attrs:{id:"writing"}},[t._v("печатает...")])])},a=[],c=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"wrapMessage"},[i("p",{staticClass:"userName"},[t._v("аноним")]),i("div",{class:{mine:t.message.mine,notMine:t.message.notMine},attrs:{id:"messageBox"},domProps:{innerHTML:t._s(t.parse())}})])},l=[],u={props:["message"],computed:{},mounted(){document.querySelector(".wrapMessage:last-child").scrollIntoView()},methods:{parse(){let t=this.message.message;for(let e=1;e<9;e++)while(-1!=t.indexOf(";s"+e+"#"))switch(t=t.split(";s"+e+"#"),e){case 1:t=t.join("<img src=https://i.smiles2k.net/aiwan_smiles/yu.gif border=0>");break;case 2:t=t.join("<img src=https://i.smiles2k.net/aiwan_smiles/yes2.gif border=0>");break;case 3:t=t.join("<img src=https://i.smiles2k.net/aiwan_smiles/yes.gif border=0>");break;case 4:t=t.join("<img src=https://i.smiles2k.net/aiwan_smiles/yahoo.gif border=0>");break;case 5:t=t.join("<img src=https://i.smiles2k.net/aiwan_smiles/wizard.gif border=0>");break;case 6:t=t.join("<img src=https://i.smiles2k.net/aiwan_smiles/wink.gif border=0>");break;case 7:t=t.join("<img src=https://i.smiles2k.net/aiwan_smiles/wacko.gif border=0>");break;case 8:t=t.join("<img src=https://i.smiles2k.net/aiwan_smiles/vinsent.gif border=0>");break}return t}}},d=u,h=(i("deee"),i("2877")),m=Object(h["a"])(d,c,l,!1,null,"af9d8550",null),p=m.exports,g=(i("3022"),{props:["messages"],data(){return{going:!1,count:0}},components:{Message:p},methods:{show(){let t=this;this.count++;let e=document.querySelector("#frame").getBoundingClientRect(),i=document.querySelector("#writing");i.style.top=e.bottom-i.getBoundingClientRect().height+"px",i.style.display="block",setTimeout((function(){0==t.count?i.style.display="none":(t.count--,0==t.count&&(i.style.display="none"))}),1e3)}},mounted(){},watch:{}}),f=g,_=(i("0808"),Object(h["a"])(f,o,a,!1,null,"cee2c086",null)),v=_.exports,b=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"Frame"}},[s("div",{attrs:{id:"imgWrapper"}},[s("img",{attrs:{src:i("3aaf"),id:"logo"},on:{click:t.openSmiles}})]),s("div",{attrs:{id:"smilesFrame"}},[s("img",{attrs:{src:"https://i.smiles2k.net/aiwan_smiles/yu.gif",border:"0"},on:{click:function(e){return t.choseSmile(1)}}}),s("img",{attrs:{src:"https://i.smiles2k.net/aiwan_smiles/yes2.gif",border:"0"},on:{click:function(e){return t.choseSmile(2)}}}),s("img",{attrs:{src:"https://i.smiles2k.net/aiwan_smiles/yes.gif",border:"0"},on:{click:function(e){return t.choseSmile(3)}}}),s("img",{attrs:{src:"https://i.smiles2k.net/aiwan_smiles/yahoo.gif",border:"0"},on:{click:function(e){return t.choseSmile(4)}}}),s("img",{attrs:{src:"https://i.smiles2k.net/aiwan_smiles/wizard.gif",border:"0"},on:{click:function(e){return t.choseSmile(5)}}}),s("img",{attrs:{src:"https://i.smiles2k.net/aiwan_smiles/wink.gif",border:"0"},on:{click:function(e){return t.choseSmile(6)}}}),s("img",{attrs:{src:"https://i.smiles2k.net/aiwan_smiles/wacko.gif",border:"0"},on:{click:function(e){return t.choseSmile(7)}}}),s("img",{attrs:{src:"https://i.smiles2k.net/aiwan_smiles/vinsent.gif",border:"0"},on:{click:function(e){return t.choseSmile(8)}}})]),s("textarea",{directives:[{name:"model",rawName:"v-model.trim",value:t.text,expression:"text",modifiers:{trim:!0}}],attrs:{id:"input",autofocus:"",placeholder:"Введите сообщение..."},domProps:{value:t.text},on:{input:[function(e){e.target.composing||(t.text=e.target.value.trim())},t.write],keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:e.ctrlKey||e.shiftKey||e.altKey||e.metaKey?null:(e.preventDefault(),t.send(e))},blur:function(e){return t.$forceUpdate()}}}),s("button",{attrs:{id:"sendButton"},on:{click:t.send}},[t._v(" отправить")])])},w=[],y={data(){return{brtext:"",text:"",opened:!1}},methods:{write(){this.$emit("write")},send(){""!=this.text?(this.$emit("send",this.text),this.text=""):this.text=""},ctrl(){""!=this.text&&(this.brtext+=this.text+"<br/>",this.text=this.text+"\n")},openSmiles(){if(this.opened){let t=document.querySelector("#smilesFrame");t.style.display="none",this.opened=!1}else{let t=document.querySelector("#smilesFrame"),e=document.querySelector("#Frame");t.style.bottom=e.getBoundingClientRect().height+12+"px",t.style.left="0px",t.style.display="block",this.opened=!0}},choseSmile(t){this.text=this.text+";s"+t+"#",document.querySelector("#input").focus()}},mounted(){let t=this;window.addEventListener("resize",(function(){t.opened=!1,document.querySelector("#smilesFrame").style.display="none"}))}},k=y,x=(i("5f54"),Object(h["a"])(k,b,w,!1,null,"7320e748",null)),S=x.exports,C=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{attrs:{id:"settings"},on:{click:t.open}},[t._v("настройки")]),t._m(0)])},j=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"settingsFrame"}},[i("div",{staticClass:"setting"},[t._v("шрифт")]),i("div",{staticClass:"setting"},[t._v("тема")]),i("div",{staticClass:"setting"},[t._v("шарики")])])}],E={data(){return{opened:!1}},methods:{open(){if(0==this.opened){let t=document.querySelector("#settings"),e=document.querySelector("#settingsFrame");e.style.display="flex";for(let i=0;i<10;i++)e.style.left=t.getBoundingClientRect().left+"px",e.style.bottom=document.documentElement.clientHeight-t.getBoundingClientRect().top+"px";window.addEventListener("resize",(function(){e.style.left=t.getBoundingClientRect().left+"px",e.style.bottom=document.documentElement.clientHeight-t.getBoundingClientRect().top+"px"})),this.opened=!0}}}},M=E,z=(i("5c3b"),Object(h["a"])(M,C,j,!1,null,"70a79e57",null)),B=z.exports;class O{constructor(t,e,i="black",s=1){t.setAttribute("width",document.documentElement.clientWidth),t.setAttribute("height",document.documentElement.clientHeight),setInterval((function(){t.setAttribute("width",document.documentElement.clientWidth),t.setAttribute("height",document.documentElement.clientHeight)}),100),this._canvas=t,this._canvasSize=t.getBoundingClientRect(),this._size=e,this._color=i,this._ctx=t.getContext("2d"),this.speed=s,this._start(this._ctx,this._canvas,this._color)}_start(t,e){this._points=[];let i=e.getBoundingClientRect().width/2,s=(e.getBoundingClientRect().height-(this._size+this._size/2))/2;for(let a=0;a<100;a++)t.beginPath(),t.arc(i,s,this._size,0,2*Math.PI),t.stroke(),this._points.push([i,s]),i=this._randomInteger(0,this._canvas.getBoundingClientRect().width),s=this._randomInteger(0,this._canvas.getBoundingClientRect().height);function n(){let t=Math.random().toString()[2];return t=+t,t>3?n():t}for(let a=0;a<this._points.length;a++)this._points[a][2]=n();function r(){t.clearRect(e.getBoundingClientRect().x,e.getBoundingClientRect().y,e.getBoundingClientRect().width,e.getBoundingClientRect().height);for(let t=0;t<this._points.length;t++){let i,s;0==this._points[t][2]?(this._points[t][1]>document.documentElement.clientHeight-this._size&&(this._points[t][2]=2),i=this._points[t][0]+0,s=this._points[t][1]+1,this._points[t][0]=this._points[t][0]+0,this._points[t][1]=this._points[t][1]+this.speed):1==this._points[t][2]?(this._points[t][0]>document.documentElement.clientWidth-this._size&&(this._points[t][2]=3),i=this._points[t][0]+1,s=this._points[t][1]+0,this._points[t][0]=this._points[t][0]+this.speed,this._points[t][1]=this._points[t][1]+0):2==this._points[t][2]?(this._points[t][1]<this._size&&(this._points[t][2]=0),i=this._points[t][0]-0,s=this._points[t][1]-1,this._points[t][0]=this._points[t][0]-0,this._points[t][1]=this._points[t][1]-this.speed):3==this._points[t][2]&&(this._points[t][0]<this._size&&(this._points[t][2]=1),i=this._points[t][0]-1,s=this._points[t][1]-0,this._points[t][0]=this._points[t][0]-this.speed,this._points[t][1]=this._points[t][1]-0);let n=e.getContext("2d");n.beginPath(),n.arc(i,s,this._size,0,2*Math.PI),n.fillStyle=this._color,n.strokeStyle=this._color,n.fill(),n.stroke()}window._stopKey=requestAnimationFrame(o)}let o=r.bind(this);o()}stop(){window.cancelAnimationFrame(window._stopKey)}_randomazer(t=1){if(1==t){let t=Math.random().toString()[2],e=Math.random().toString()[2],i=t+e;return i=+i,i}}_randomInteger(t,e){let i=t-.5+Math.random()*(e-t+1);return Math.round(i)}setSize(t){this._size=t}setSpeed(t){this.speed=t}}var R={data(){return{messages:[],size:document.documentElement.clientHeight}},methods:{send(t){this.$set(this.messages,this.messages.length,{message:t,mine:!0}),CometServer().web_pipe_send("web_chat","message",t)},write(){CometServer().web_pipe_send("web_chat_write","write")}},components:{ChatFrame:v,Input:S,Settings:B},mounted(){let t=this,e=document.querySelector("canvas");new O(e,5,"#ff9933",.5),$.getScript("CometServerApi.js",(function(){CometServer().start({dev_id:2778}),CometServer().subscription("web_chat",(function(e){t.$set(t.messages,t.messages.length,{message:e.data,notMine:!0})})),CometServer().subscription("web_chat_write",(function(e){t.$refs.chatframe.show()}))}))}},F=R,P=(i("cde7"),Object(h["a"])(F,n,r,!1,null,"0fb8bc4e",null)),q=P.exports,I=i("8c4f");s["a"].use(I["a"]);const A=[{path:"/",name:"home"}],H=new I["a"]({mode:"history",routes:A});var K=H,T=i("2f62");s["a"].use(T["a"]);var W=new T["a"].Store({state:{},mutations:{},actions:{},modules:{}});s["a"].config.productionTip=!1,new s["a"]({router:K,store:W,render:function(t){return t(q)}}).$mount("#app")},"5c3b":function(t,e,i){"use strict";var s=i("6d59"),n=i.n(s);n.a},"5f54":function(t,e,i){"use strict";var s=i("e7e8"),n=i.n(s);n.a},"65ee":function(t,e,i){},"6d59":function(t,e,i){},c9f7:function(t,e,i){},cde7:function(t,e,i){"use strict";var s=i("c9f7"),n=i.n(s);n.a},deee:function(t,e,i){"use strict";var s=i("65ee"),n=i.n(s);n.a},e7e8:function(t,e,i){}});
//# sourceMappingURL=app.f82a70fb.js.map